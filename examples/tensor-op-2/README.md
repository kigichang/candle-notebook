# å¼µé‡å…¶ä»–æ“ä½œ

## ä¸€ã€å‡ç¶­èˆ‡é™ç¶­

### 1. å‡ç¶­ `t.unsqueeze`

åœ¨å¼µé‡ä¸­ï¼Œå¯ä»¥é€é `t.unsqueeze` å‡½å¼ï¼ŒæŒ‡å®šæ“´å±•çš„ç¶­åº¦ï¼Œç”¢ç”Ÿæ–°çš„å¼µé‡ã€‚æ–°çš„å¼µé‡æœƒæ¯”åŸå¼µé‡å¤š 1 ç¶­ï¼Œä¸”æŒ‡å®šç¶­åº¦çš„å¤§å°ç‚º **1**ã€‚ä¾‹å¦‚å¼µé‡ `t` æ˜¯ **3x4** å¼µé‡ï¼š

* `t.unsqueeze(0)`: æœƒç”¢ç”Ÿ **1x3x4** å¼µé‡ã€‚
* `t.unsqueeze(1)`: æœƒç”¢ç”Ÿ **3x1x4** å¼µé‡ã€‚
* `t.unsqueeze(2)`: æœƒç”¢ç”Ÿ **3x4x1** å¼µé‡ã€‚
* `t.unsqueeze(3)`: æœƒç™¼ç”ŸéŒ¯èª¤ã€‚

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_squeeze.rs](../../tests/tensor_squeeze.rs)

### 2. é™ç¶­ `t.squeeze`

åœ¨å¼µé‡ä¸­ï¼Œå¯ä»¥é€é `t.squeeze` å‡½å¼ï¼ŒæŒ‡å®šè¦åˆªé™¤çš„ç¶­åº¦ï¼Œç”¢ç”Ÿæ–°çš„å¼µé‡ã€‚æ–°çš„å¼µé‡æœƒæ¯”åŸå¼µé‡å°‘ 1 ç¶­ï¼Œä¸”æŒ‡å®šç¶­åº¦çš„å¤§å°å¿…é ˆç‚º **1**ã€‚é€éæºå§‹ç¢¼è¨»è§£èªªæ˜ï¼Œç‚ºèˆ‡ Pytorch è¡Œç‚ºä¸€è‡´ï¼Œå¦‚æœç™¼ç”ŸéŒ¯èª¤æ™‚ï¼Œæœƒå›å‚³èˆ‡åŸå¼µé‡ç›¸åŒçš„å¼µé‡ã€‚

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_squeeze.rs](../../tests/tensor_squeeze.rs)

## äºŒã€è¨ˆç®—å¼µé‡å…§å®¹

### 1. ç¸½å’Œ `t.sum`, `t.sum_keepdim` and `t.sum_all`

è¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„ç¸½å’Œæˆ–æ•´å€‹å¼µé‡ç¸½å’Œã€‚

1. `t.sum(index)`: è¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„ç¸½å’Œã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒæ¯”åŸå¼µé‡å°‘ 1 ç¶­ã€‚
1. `t.sum_keepdim(index)`: è¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„ç¸½å’Œã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒèˆ‡åŸå¼µé‡ç›¸åŒã€‚`t.sum_keepdim` ç­‰åŒåšå®Œ `t.sum` å¾Œï¼Œå†åš `t.unsqueeze`ã€‚
1. `t.sum_all()`: è¨ˆç®—æ•´å€‹å¼µé‡çš„ç¸½å’Œã€‚çµæœæ˜¯ä¸€å€‹ç´”é‡ã€‚

æ•´ç†å…¶æ•¸å­¸åŸç†ï¼Œå‡è¨­å¼µé‡ `t` æ˜¯ **2x3x4** å¼µé‡ï¼Œå‰‡ï¼š

* `t.sum(0)`:

    $$
    S_{j,k} = \sum_{i=0}^{2} t_{i,j,k}
    $$

* `t.sum(1)`:

    $$
    S_{i,k} = \sum_{j=0}^{3} t_{i,j,k}
    $$

* `t.sum(2)`:

    $$
    S_{i,j} = \sum_{k=0}^{4} t_{i,j,k}
    $$

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_sum.rs](../../tests/tensor_sum.rs)

### 2. å¹³å‡å€¼ `t.mean`, `t.mean_keepdim` and `t.mean_all`

é¡ä¼¼ç¸½å’Œï¼Œè¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„å¹³å‡æˆ–æ•´å€‹å¼µé‡å¹³å‡å€¼ã€‚

1. `t.mean(index)`: è¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„å¹³å‡å€¼ã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒæ¯”åŸå¼µé‡å°‘ 1 ç¶­ã€‚
1. `t.mean_keepdim(index)`: è¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„å¹³å‡å€¼ã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒèˆ‡åŸå¼µé‡ç›¸åŒã€‚`t.mean_keepdim` ç­‰åŒåšå®Œ `t.mean` å¾Œï¼Œå†åš `t.unsqueeze`ã€‚
1. `t.mean_all()`: è¨ˆç®—æ•´å€‹å¼µé‡çš„å¹³å‡ã€‚çµæœæ˜¯ä¸€å€‹ç´”é‡ã€‚

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_mean.rs](../../tests/tensor_mean.rs)

### 3. æœ€å¤§å€¼ `t.max` and `t.max_keepdim`

é¡ä¼¼ç¸½å’Œï¼Œè¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å¤§å€¼ã€‚

1. `t.max(index)`: è¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å¤§å€¼ã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒæ¯”åŸå¼µé‡å°‘ 1 ç¶­ã€‚
1. `t.max_keepdim(index)`: è¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å¤§å€¼ã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒèˆ‡åŸå¼µé‡ç›¸åŒã€‚`t.max_keepdim` ç­‰åŒåšå®Œ `t.max` å¾Œï¼Œå†åš `t.unsqueeze`ã€‚

### 4. æœ€å°å€¼ `t.min` and `t.min_keepdim`

é¡ä¼¼ç¸½å’Œï¼Œè¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å°å€¼ã€‚

1. `t.min(index)`: è¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å°å€¼ã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒæ¯”åŸå¼µé‡å°‘ 1 ç¶­ã€‚
1. `t.min_keepdim(index)`: è¨ˆç®—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å°å€¼ã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒèˆ‡åŸå¼µé‡ç›¸åŒã€‚`t.min_keepdim` ç­‰åŒåšå®Œ `t.min` å¾Œï¼Œå†åš `t.unsqueeze`ã€‚

### 5. æœ€å¤§å€¼èˆ‡æœ€å°å€¼ç´¢å¼• `t.argmax`, `t.argmax_keepdim`, `t.argmin` and `t.argmin_keepdim`

å–å¾—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å¤§å€¼èˆ‡æœ€å°å€¼ç´¢å¼•ï¼Œå›å‚³çš„å¼µé‡è³‡æ–™å‹åˆ¥æ˜¯ `u32`ã€‚

1. `t.argmax(index)`: å–å¾—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å¤§å€¼ç´¢å¼•ã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒæ¯”åŸå¼µé‡å°‘ 1 ç¶­ã€‚
1. `t.argmax_keepdim(index)`: å–å¾—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å¤§å€¼ç´¢å¼•ã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒèˆ‡åŸå¼µé‡ç›¸åŒã€‚`t.argmax_keepdim` ç­‰åŒåšå®Œ `t.argmax` å¾Œï¼Œå†åš `t.unsqueeze`ã€‚
1. `t.argmin(index)`: å–å¾—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å°å€¼ç´¢å¼•ã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒæ¯”åŸå¼µé‡å°‘ 1 ç¶­ã€‚
1. `t.argmin_keepdim(index)`: å–å¾—å¼µé‡æŸå€‹ç¶­åº¦çš„æœ€å°å€¼ç´¢å¼•ã€‚çµæœçš„å¼µé‡ç¶­åº¦æœƒèˆ‡åŸå¼µé‡ç›¸åŒã€‚`t.argmin_keepdim` ç­‰åŒåšå®Œ `t.argmin` å¾Œï¼Œå†åš `t.unsqueeze`ã€‚

## ä¸‰ã€å…©å€‹å¼µé‡æ¯”è¼ƒ

### 1. å…©å€‹å½¢ç‹€ç›¸åŒå¼µé‡ï¼Œå–æœ€å¤§èˆ‡æœ€å°å€¼

#### `t.maximum`

ä½¿ç”¨ `t.maximum` æ¯”è¼ƒå…©å€‹å¼µé‡çš„æ¯å€‹å…ƒç´ ï¼Œå–æœ€å¤§å€¼ã€‚ç”±æºç¢¼ä¾†çœ‹ï¼Œå³é‹ç®—å­æ˜¯ `TensorOrScalar`ï¼Œå¯ä»¥æ˜¯ï¼š

1. ç´”é‡(æ•¸å€¼ï¼Œéç´”é‡å¼µé‡)ï¼Œè³‡æ–™å‹åˆ¥å¯ä»¥èˆ‡å·¦é‹ç®—å…ƒå¼µé‡ä¸åŒã€‚
1. å¼µé‡ï¼Œå‰‡å…©å€‹å¼µé‡å½¢ç‹€èˆ‡å‹åˆ¥å¿…é ˆç›¸åŒã€‚

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_maximum.rs](../../tests/tensor_maximum.rs)

#### `t.minimum`

é¡ä¼¼ `t.maximun`ï¼Œ`t.minimum` æ¯”è¼ƒå…©å€‹å¼µé‡çš„æ¯å€‹å…ƒç´ ï¼Œå–æœ€å°å€¼ã€‚

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_minimum.rs](../../tests/tensor_minimum.rs)

### 2. æ¯”è¼ƒå…©å€‹å½¢ç‹€ç›¸åŒå¼µé‡é—œä¿‚ `t.eq`, `t.ne`, `t.lt`, `t.le`, `t.gt` and `t.ge`

é¡ä¼¼ `t.maximun`ï¼Œå³é‹ç®—å­ä¹Ÿæ˜¯ `TensorOrScalar`ï¼Œå›å‚³å¼µé‡çš„å‹åˆ¥æ˜¯ `u8`ï¼Œå¦‚æœå…©å€‹å¼µé‡å…§çš„å…ƒç´ ï¼Œç¬¦åˆæ¯”è¼ƒçš„é—œä¿‚ï¼Œå‰‡å›å‚³å€¼ç‚º **1**ï¼Œå¦å‰‡ç‚º **0**ã€‚å‡½å¼èªªæ˜å¦‚ä¸‹ï¼š

1. `eq`: ç­‰æ–¼ (equal)
1. `ne`: ä¸ç­‰æ–¼ (not equal)
1. `lt`: å°æ–¼ (less than)
1. `le`: å°æ–¼ç­‰æ–¼ (less or equal)
1. `gt`: å¤§æ–¼ (greater than)
1. `ge`: å¤§æ–¼ç­‰æ–¼ (greater or equal)

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_compare.rs](../../tests/tensor_compare.rs)

## 3. ä¸åŒå½¢ç‹€å¼µé‡å–æœ€å¤§èˆ‡æœ€å°å€¼ `t.broadcast_maximum` and `t.broadcast_minimum`

`t.broadcast_maximum` å’Œ `t.broadcast_minimum`ï¼Œéƒ½æ˜¯å…ˆç”¨ `broadcast_as` å°‡å…©å€‹å¼µé‡èª¿æ•´æˆä¸€è‡´ï¼Œå†ä½¿ç”¨ `maximum` å’Œ `minimum` é€²è¡Œæ¯”è¼ƒã€‚å› æ­¤å·¦ã€å³å…©å€‹é‹ç®—å…ƒçš„å¼µé‡å½¢ç‹€å¿…é ˆç›¸å®¹ã€‚

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_broadcast_max_and_min.rs](../../tests/tensor_broadcast_max_and_min.rs)

### 4. æ¯”è¼ƒå…©å€‹ä¸åŒå½¢ç‹€å¼µé‡é—œä¿‚ `t.broadcast_eq`, `t.broadcast_ne`, `t.broadcast_lt`, `t.broadcast_le`, `t.broadcast_gt` and `t.broadcast_ge`

èˆ‡ `t.broadcast_maximum` å’Œ `t.broadcast_minimum` é¡ä¼¼ï¼Œéƒ½æ˜¯å…ˆç”¨ `broadcast_as` å°‡å…©å€‹å¼µé‡èª¿æ•´æˆä¸€è‡´ï¼Œå†ä½¿ç”¨å°æ‡‰çš„å‡½å¼é€²è¡Œæ¯”è¼ƒã€‚å› æ­¤å·¦ã€å³å…©å€‹é‹ç®—å…ƒçš„å¼µé‡å½¢ç‹€å¿…é ˆç›¸å®¹ã€‚

å‡½å¼å°æ‡‰é—œä¿‚è¡¨

| broadcast         | å…§éƒ¨ä½¿ç”¨å‡½å¼ | åŠŸèƒ½    |
|-------------------|------------|--------|
| broadcast_maximum | maximum    | æœ€å¤§å€¼  |
| broadcast_minimum | minimum    | æœ€å°å€¼  |
| broadcast_eq      | eq         | ç­‰æ–¼    |
| broadcast_ne      | ne         | ä¸ç­‰æ–¼  |
| broadcast_lt      | lt         | å°æ–¼    |
| broadcast_le      | le         | å°æ–¼ç­‰æ–¼ |
| broadcast_gt      | gt         | å¤§æ–¼    |
| broadcast_ge      | ge         | å¤§æ–¼ç­‰æ–¼ |

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_broadcast_compare.rs](../../tests/tensor_broadcast_compare.rs)

## å››ã€çµ„åˆå¤šå€‹å¼µé‡

### 1. é€£æ¥å¤šå€‹å¼µé‡

å¯ä»¥ä½¿ç”¨ `Tensor::cat` åœ¨æŒ‡å®šçš„ç¶­åº¦ä¸Šï¼Œé€£æ¥å¤šå€‹å¼µé‡ã€‚æ“ä½œæ™‚ï¼Œæ¯å€‹å¼µé‡çš„ç¶­åº¦å¿…é ˆç›¸åŒï¼Œä¸”åªèƒ½æŒ‡å®šçš„ç¶­åº¦å¯ä»¥å…è¨±ä¸åŒå¤§å°ï¼Œå…¶é¤˜çš„ç¶­åº¦å¤§å°å¿…é ˆç›¸åŒã€‚çµæœçš„å¼µé‡ç¶­åº¦èˆ‡è¼¸å…¥å¼µé‡ç›¸åŒã€‚ä¾‹å¦‚ï¼š2x3x4 å¼µé‡èˆ‡ 2x2x4 å¼µé‡ï¼Œåœ¨ç¬¬ 2 ç¶­é€£æ¥æ™‚ï¼Œæœƒç”¢ç”Ÿ 2x5x4 çš„å¼µé‡ã€‚

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_cat.rs](../../tests/tensor_cat.rs)

### 2. å †ç–Šå¤šå€‹å¼µé‡

å¯ä»¥ä½¿ç”¨ `Tensor::stack` åœ¨æŒ‡å®šçš„ç¶­åº¦ä¸Šï¼Œå †ç–Šå¤šå€‹å¼µé‡ï¼Œæ“ä½œæ™‚ï¼Œæ¯å€‹å¼µé‡çš„ç¶­åº¦å½¢ç‹€å¿…é ˆç›¸åŒã€‚ç”±æºç¢¼ä¾†çœ‹ï¼Œ`Tensor::stack` ç­‰åŒæ¯å€‹å¼µé‡å…ˆåš `t.unsqueeze`ï¼Œç„¶å¾Œå†ä½œ`Tensor::cat`ï¼Œå› æ­¤çµæœçš„å¼µé‡ç¶­åº¦æ¯”è¼¸å…¥å¼µé‡å¤šä¸€ç¶­ã€‚

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_stack.rs](../../tests/tensor_stack.rs)

## äº”ã€å¼µé‡è½‰ç½®

å¯ä»¥ä½¿ç”¨ `t.transpose` å°èª¿å…©å€‹æŒ‡å®šçš„ç¶­åº¦ã€‚ä»¥ä¸€èˆ¬ 2 ç¶­çŸ©é™£ä¾†èªªï¼Œå¯ä»¥ç”¨ `t.transpose(0, 1)` å–å¾—è½‰ç½®çŸ©é™£ã€‚è€Œ `t.t()` æ˜¯å°èª¿æœ€å¾Œå…©ç¶­å¾Œçš„å¼µé‡ã€‚ç­‰åŒ `t.transpose(D::Minus2, D::Minus1)`ã€‚

ğŸ‘‰ ç¯„ä¾‹ç¨‹å¼ï¼š[tensor_transpose.rs](../../tests/tensor_transpose.rs)

## gather

## index and contiguous
